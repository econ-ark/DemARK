

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>The Life Cycle Model: Theory vs Data &#8212; DemARK</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/LifeCycleModelTheoryVsData';</script>
    <link rel="shortcut icon" href="../_static/econ-ark-logo-small.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lucas Asset Pricing Model" href="Lucas-Asset-Pricing-Model.html" />
    <link rel="prev" title="Expectated vs Realized Income Growth in A Standard Life Cycle Model" href="LC-Model-Expected-Vs-Realized-Income-Growth.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/econ-ark-logo.png" class="logo__image only-light" alt="DemARK - Home"/>
    <script>document.write(`<img src="../_static/econ-ark-logo.png" class="logo__image only-dark" alt="DemARK - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    DemARK
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Alternative-Combos-Of-Parameter-Values.html">Alternative Combinations of Parameter Values</a></li>


<li class="toctree-l1"><a class="reference internal" href="ChangeLiqConstr.html">What Happens To the Consumption Function When A Liquidity Constraint is Tightened?</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chinese-Growth.html">Do Precautionary Motives Explain China’s High Saving Rate?</a></li>
<li class="toctree-l1"><a class="reference internal" href="DCEGM-Upper-Envelope.html">DCEGM Upper Envelope</a></li>






<li class="toctree-l1"><a class="reference internal" href="DiamondOLG.html">The Diamond OLG Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="FisherTwoPeriod.html">The Fisher Two-Period Optimal Consumption Problem</a></li>

<li class="toctree-l1"><a class="reference internal" href="Gentle-Intro-To-HARK-Buffer-Stock-Model.html">A Gentle Introduction to HARK: Buffer Stock Saving</a></li>
<li class="toctree-l1"><a class="reference internal" href="Gentle-Intro-To-HARK-PerfForesightCRRA.html">A Gentle Introduction to HARK: The Perfect Foresight Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="Harmenberg-Aggregation.html">A Demonstration of the Harmenberg (2021) Aggregation Method</a></li>







<li class="toctree-l1"><a class="reference internal" href="IncExpectationExample.html">The Persistent Shock Model and Income Expectations</a></li>
<li class="toctree-l1"><a class="reference internal" href="KeynesFriedmanModigliani.html">Introduction: Keynes, Friedman, Modigliani</a></li>
<li class="toctree-l1"><a class="reference internal" href="LC-Model-Expected-Vs-Realized-Income-Growth.html">Expectated vs Realized Income Growth in A Standard Life Cycle Model</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">The Life Cycle Model: Theory vs Data</a></li>

<li class="toctree-l1"><a class="reference internal" href="Lucas-Asset-Pricing-Model.html">Lucas Asset Pricing Model</a></li>





<li class="toctree-l1"><a class="reference internal" href="MPC-Out-of-Credit-vs-MPC-Out-of-Income.html">The MPC out of Credit vs the MPC Out of Income</a></li>
<li class="toctree-l1"><a class="reference internal" href="Micro-and-Macro-Implications-of-Very-Impatient-HHs.html">Micro- and Macroeconomic Implications of Very Impatient Households</a></li>

<li class="toctree-l1"><a class="reference internal" href="Nondurables-During-Great-Recession.html">Spending on Nondurables During the Great Recession</a></li>
<li class="toctree-l1"><a class="reference internal" href="PerfForesightCRRA-Approximation.html">Perfect Foresight CRRA Model - Approximation</a></li>
<li class="toctree-l1"><a class="reference internal" href="PerfForesightCRRA-SavingRate.html">Perfect Foresight CRRA Model - Saving Rate</a></li>
<li class="toctree-l1"><a class="reference internal" href="Structural-Estimates-From-Empirical-MPCs-Fagereng-et-al.html">Making Structural Estimates From Empirical Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="TractableBufferStock-Interactive.html">The Tractable Buffer Stock Model</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/econ-ark/DemARK/master?urlpath=lab/tree/notebooks/LifeCycleModelTheoryVsData.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://hub.econ-ark.org/hub/user-redirect/git-pull?repo=https%3A//github.com/econ-ark/DemARK&urlpath=lab/tree/DemARK/notebooks/LifeCycleModelTheoryVsData.ipynb&branch=master" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/econ-ark/DemARK/blob/master/notebooks/LifeCycleModelTheoryVsData.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/LifeCycleModelTheoryVsData.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>The Life Cycle Model: Theory vs Data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">The Life Cycle Model: Theory vs Data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-rates-and-lifetime-income-growth">Saving Rates and Lifetime Income Growth</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="the-life-cycle-model-theory-vs-data">
<h1>The Life Cycle Model: Theory vs Data<a class="headerlink" href="#the-life-cycle-model-theory-vs-data" title="Permalink to this heading">#</a></h1>
<p><a class="reference external" href="https://econ-ark.org/materials/lifecyclemodeltheoryvsdata#launch"><img alt="badge" src="https://img.shields.io/badge/Launch%20using%20-Econ--ARK-blue" /></a></p>
<p>National registry data on income and wealth from Scandinavian countries (esp. Norway) have recently become available (with a lot of security) to some (lucky!) researchers.   These data offer a uniquely powerful tool for testing (and improving) our models of consumption and saving behavior over the life cycle.</p>
<p>This notebook is an example of how to construct a life cycle model with the HARK toolkit that makes predictions that can be compared to the raw data statistics=.</p>
<p>For example, some papers have tabulated information about the <strong>growth rate</strong> of assets at different ages over the life cycle.</p>
<p>The default parameters of the HARK life cycle model have not been optmized to match features of the Norwegian data; a first step in a real “structural” estimation would be to use Norwegian calibrate the inputs to the model (like the profile of income, and the magnitude of income shocks, over the life cycle), and then to find the values of parameters like the time preference rate that allow the model to fit the data best.  (See <a class="reference external" href="https://www.econ2.jhu.edu/people/ccarroll/SolvingMicroDSOPs">SolvingMicroDSOPs</a> for how this can be done, and search for the corresponding HARK content using <a class="reference external" href="https://hark.readthedocs.io">our documentation</a>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initial imports and notebook setup, click arrow to show</span>

<span class="c1"># The consumption-saving micro model</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">HARK.ConsumptionSaving.ConsIndShockModel</span> <span class="k">as</span> <span class="nn">cShksModl</span>
<span class="kn">from</span> <span class="nn">HARK.utilities</span> <span class="kn">import</span> <span class="n">plot_funcs</span>  <span class="c1"># Some tools</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ---------------------------------------------------------------------------------</span>
<span class="c1"># - Define all of the model parameters for SolvingMicroDSOPs and ConsumerExamples -</span>
<span class="c1"># ---------------------------------------------------------------------------------</span>

<span class="n">exp_nest</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Number of times to &quot;exponentially nest&quot; when constructing a_grid</span>
<span class="n">aXtraMin</span> <span class="o">=</span> <span class="mf">0.001</span>  <span class="c1"># Minimum end-of-period &quot;assets above minimum&quot; value</span>
<span class="n">aXtraMax</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># Maximum end-of-period &quot;assets above minimum&quot; value</span>
<span class="n">aXtraHuge</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># A very large value of assets to add to the grid, not used</span>
<span class="n">aXtraExtra</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Some other value of assets to add to the grid, not used</span>
<span class="n">aXtraCount</span> <span class="o">=</span> <span class="mi">8</span>  <span class="c1"># Number of points in the grid of &quot;assets above minimum&quot;</span>

<span class="c1"># Artificial borrowing constraint; imposed minimum level of end-of period assets</span>
<span class="n">BoroCnstArt</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">CubicBool</span> <span class="o">=</span> <span class="p">(</span>
    <span class="kc">True</span>  <span class="c1"># Use cubic spline interpolation when True, linear interpolation when False</span>
<span class="p">)</span>
<span class="n">vFuncBool</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Whether to calculate the value function during solution</span>

<span class="n">Rfree</span> <span class="o">=</span> <span class="mf">1.03</span>  <span class="c1"># Interest factor on assets</span>
<span class="n">PermShkCount</span> <span class="o">=</span> <span class="p">(</span>
    <span class="mi">7</span>  <span class="c1"># Number of points in discrete approximation to permanent income shocks</span>
<span class="p">)</span>
<span class="n">TranShkCount</span> <span class="o">=</span> <span class="p">(</span>
    <span class="mi">7</span>  <span class="c1"># Number of points in discrete approximation to transitory income shocks</span>
<span class="p">)</span>
<span class="n">UnempPrb</span> <span class="o">=</span> <span class="mf">0.005</span>  <span class="c1"># Probability of unemployment while working</span>
<span class="n">UnempPrbRet</span> <span class="o">=</span> <span class="mf">0.000</span>  <span class="c1"># Probability of &quot;unemployment&quot; while retired</span>
<span class="n">IncUnemp</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Unemployment benefits replacement rate</span>
<span class="n">IncUnempRet</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># &quot;Unemployment&quot; benefits when retired</span>

<span class="n">final_age</span> <span class="o">=</span> <span class="mi">90</span>  <span class="c1"># Age at which the problem ends (die with certainty)</span>
<span class="n">retirement_age</span> <span class="o">=</span> <span class="mi">65</span>  <span class="c1"># Age at which the consumer retires</span>
<span class="n">initial_age</span> <span class="o">=</span> <span class="mi">25</span>  <span class="c1"># Age at which the consumer enters the model</span>
<span class="n">TT</span> <span class="o">=</span> <span class="n">final_age</span> <span class="o">-</span> <span class="n">initial_age</span>  <span class="c1"># Total number of periods in the model</span>
<span class="n">retirement_t</span> <span class="o">=</span> <span class="n">retirement_age</span> <span class="o">-</span> <span class="n">initial_age</span> <span class="o">-</span> <span class="mi">1</span>

<span class="c1"># Initial guess of the coefficient of relative risk aversion during estimation (rho)</span>
<span class="n">CRRA_start</span> <span class="o">=</span> <span class="mf">4.0</span>
<span class="c1"># Initial guess of the adjustment to the discount factor during estimation (beth)</span>
<span class="n">DiscFacAdj_start</span> <span class="o">=</span> <span class="mf">0.99</span>
<span class="n">DiscFacAdj_bound</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">0.0001</span><span class="p">,</span>
    <span class="mf">15.0</span><span class="p">,</span>
<span class="p">]</span>  <span class="c1"># Bounds for beth; if violated, objective function returns &quot;penalty value&quot;</span>
<span class="n">CRRA_bound</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">0.0001</span><span class="p">,</span>
    <span class="mf">15.0</span><span class="p">,</span>
<span class="p">]</span>  <span class="c1"># Bounds for rho; if violated, objective function returns &quot;penalty value&quot;</span>

<span class="c1"># Expected growth rates of permanent income over the lifecycle, starting from age 25</span>
<span class="n">PermGroFac</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.025</span><span class="p">,</span>
    <span class="mf">1.01</span><span class="p">,</span>
    <span class="mf">1.01</span><span class="p">,</span>
    <span class="mf">1.01</span><span class="p">,</span>
    <span class="mf">1.01</span><span class="p">,</span>
    <span class="mf">1.01</span><span class="p">,</span>
    <span class="mf">1.01</span><span class="p">,</span>
    <span class="mf">1.01</span><span class="p">,</span>
    <span class="mf">1.01</span><span class="p">,</span>
    <span class="mf">1.01</span><span class="p">,</span>
    <span class="mf">1.01</span><span class="p">,</span>
    <span class="mf">1.01</span><span class="p">,</span>
    <span class="mf">1.01</span><span class="p">,</span>
    <span class="mf">1.01</span><span class="p">,</span>
    <span class="mf">1.01</span><span class="p">,</span>
    <span class="mf">0.7</span><span class="p">,</span>  <span class="c1"># &lt;-- This represents retirement</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
<span class="p">]</span>

<span class="c1"># Age-varying discount factors over the lifecycle, lifted from Cagetti (2003)</span>
<span class="n">DiscFac_timevary</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">1.064914</span><span class="p">,</span>
    <span class="mf">1.057997</span><span class="p">,</span>
    <span class="mf">1.051422</span><span class="p">,</span>
    <span class="mf">1.045179</span><span class="p">,</span>
    <span class="mf">1.039259</span><span class="p">,</span>
    <span class="mf">1.033653</span><span class="p">,</span>
    <span class="mf">1.028352</span><span class="p">,</span>
    <span class="mf">1.023348</span><span class="p">,</span>
    <span class="mf">1.018632</span><span class="p">,</span>
    <span class="mf">1.014198</span><span class="p">,</span>
    <span class="mf">1.010037</span><span class="p">,</span>
    <span class="mf">1.006143</span><span class="p">,</span>
    <span class="mf">1.002509</span><span class="p">,</span>
    <span class="mf">0.9991282</span><span class="p">,</span>
    <span class="mf">0.9959943</span><span class="p">,</span>
    <span class="mf">0.9931012</span><span class="p">,</span>
    <span class="mf">0.9904431</span><span class="p">,</span>
    <span class="mf">0.9880143</span><span class="p">,</span>
    <span class="mf">0.9858095</span><span class="p">,</span>
    <span class="mf">0.9838233</span><span class="p">,</span>
    <span class="mf">0.9820506</span><span class="p">,</span>
    <span class="mf">0.9804866</span><span class="p">,</span>
    <span class="mf">0.9791264</span><span class="p">,</span>
    <span class="mf">0.9779656</span><span class="p">,</span>
    <span class="mf">0.9769995</span><span class="p">,</span>
    <span class="mf">0.9762239</span><span class="p">,</span>
    <span class="mf">0.9756346</span><span class="p">,</span>
    <span class="mf">0.9752274</span><span class="p">,</span>
    <span class="mf">0.9749984</span><span class="p">,</span>
    <span class="mf">0.9749437</span><span class="p">,</span>
    <span class="mf">0.9750595</span><span class="p">,</span>
    <span class="mf">0.9753422</span><span class="p">,</span>
    <span class="mf">0.9757881</span><span class="p">,</span>
    <span class="mf">0.9763936</span><span class="p">,</span>
    <span class="mf">0.9771553</span><span class="p">,</span>
    <span class="mf">0.9780698</span><span class="p">,</span>
    <span class="mf">0.9791338</span><span class="p">,</span>
    <span class="mf">0.9803439</span><span class="p">,</span>
    <span class="mf">0.981697</span><span class="p">,</span>
    <span class="mf">0.8287214</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
    <span class="mf">0.9902111</span><span class="p">,</span>
<span class="p">]</span>

<span class="c1"># Survival probabilities over the lifecycle, starting from age 25</span>
<span class="n">LivPrb</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># &lt;-- automatic survival to age 65</span>
    <span class="mf">0.98438596</span><span class="p">,</span>
    <span class="mf">0.98438596</span><span class="p">,</span>
    <span class="mf">0.98438596</span><span class="p">,</span>
    <span class="mf">0.98438596</span><span class="p">,</span>
    <span class="mf">0.98438596</span><span class="p">,</span>
    <span class="mf">0.97567062</span><span class="p">,</span>
    <span class="mf">0.97567062</span><span class="p">,</span>
    <span class="mf">0.97567062</span><span class="p">,</span>
    <span class="mf">0.97567062</span><span class="p">,</span>
    <span class="mf">0.97567062</span><span class="p">,</span>
    <span class="mf">0.96207901</span><span class="p">,</span>
    <span class="mf">0.96207901</span><span class="p">,</span>
    <span class="mf">0.96207901</span><span class="p">,</span>
    <span class="mf">0.96207901</span><span class="p">,</span>
    <span class="mf">0.96207901</span><span class="p">,</span>
    <span class="mf">0.93721595</span><span class="p">,</span>
    <span class="mf">0.93721595</span><span class="p">,</span>
    <span class="mf">0.93721595</span><span class="p">,</span>
    <span class="mf">0.93721595</span><span class="p">,</span>
    <span class="mf">0.93721595</span><span class="p">,</span>
    <span class="mf">0.63095734</span><span class="p">,</span>
    <span class="mf">0.63095734</span><span class="p">,</span>
    <span class="mf">0.63095734</span><span class="p">,</span>
    <span class="mf">0.63095734</span><span class="p">,</span>
    <span class="mf">0.63095734</span><span class="p">,</span>
<span class="p">]</span>


<span class="c1"># Standard deviations of permanent income shocks by age, starting from age 25</span>
<span class="n">PermShkStd</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># &lt;-- no permanent income shocks after retirement</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
<span class="p">]</span>

<span class="c1"># Standard deviations of transitory income shocks by age, starting from age 25</span>
<span class="n">TranShkStd</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># &lt;-- no transitory income shocs after retirement</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
<span class="p">]</span>

<span class="c1"># Age groups for the estimation: calculate average wealth-to-permanent income ratio</span>
<span class="c1"># for consumers within each of these age groups, compare actual to simulated data</span>
<span class="n">empirical_cohort_age_groups</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">35</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">36</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">41</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">45</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">46</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">51</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">56</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">initial_wealth_income_ratio_vals</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">0.17</span><span class="p">,</span>
    <span class="mf">0.5</span><span class="p">,</span>
    <span class="mf">0.83</span><span class="p">,</span>
<span class="p">]</span>  <span class="c1"># Three point discrete distribution of initial w</span>
<span class="n">initial_wealth_income_ratio_probs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">0.33333</span><span class="p">,</span>
    <span class="mf">0.33333</span><span class="p">,</span>
    <span class="mf">0.33334</span><span class="p">,</span>
<span class="p">]</span>  <span class="c1"># Equiprobable discrete distribution of initial w</span>
<span class="n">num_agents</span> <span class="o">=</span> <span class="mi">10000</span>  <span class="c1"># Number of agents to simulate</span>
<span class="n">bootstrap_size</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Number of re-estimations to do during bootstrap</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">31382</span>  <span class="c1"># Just an integer to seed the estimation</span>


<span class="c1"># Dictionary that can be passed to ConsumerType to instantiate</span>
<span class="n">init_consumer_objects</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;CRRA&quot;</span><span class="p">:</span> <span class="n">CRRA_start</span><span class="p">,</span>
    <span class="s2">&quot;Rfree&quot;</span><span class="p">:</span> <span class="n">Rfree</span><span class="p">,</span>
    <span class="s2">&quot;PermGroFac&quot;</span><span class="p">:</span> <span class="n">PermGroFac</span><span class="p">,</span>
    <span class="s2">&quot;BoroCnstArt&quot;</span><span class="p">:</span> <span class="n">BoroCnstArt</span><span class="p">,</span>
    <span class="s2">&quot;PermShkStd&quot;</span><span class="p">:</span> <span class="n">PermShkStd</span><span class="p">,</span>
    <span class="s2">&quot;PermShkCount&quot;</span><span class="p">:</span> <span class="n">PermShkCount</span><span class="p">,</span>
    <span class="s2">&quot;TranShkStd&quot;</span><span class="p">:</span> <span class="n">TranShkStd</span><span class="p">,</span>
    <span class="s2">&quot;TranShkCount&quot;</span><span class="p">:</span> <span class="n">TranShkCount</span><span class="p">,</span>
    <span class="s2">&quot;T_cycle&quot;</span><span class="p">:</span> <span class="n">TT</span><span class="p">,</span>
    <span class="s2">&quot;UnempPrb&quot;</span><span class="p">:</span> <span class="n">UnempPrb</span><span class="p">,</span>
    <span class="s2">&quot;UnempPrbRet&quot;</span><span class="p">:</span> <span class="n">UnempPrbRet</span><span class="p">,</span>
    <span class="s2">&quot;T_retire&quot;</span><span class="p">:</span> <span class="n">retirement_t</span><span class="p">,</span>
    <span class="s2">&quot;T_age&quot;</span><span class="p">:</span> <span class="n">TT</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;IncUnemp&quot;</span><span class="p">:</span> <span class="n">IncUnemp</span><span class="p">,</span>
    <span class="s2">&quot;IncUnempRet&quot;</span><span class="p">:</span> <span class="n">IncUnempRet</span><span class="p">,</span>
    <span class="s2">&quot;aXtraMin&quot;</span><span class="p">:</span> <span class="n">aXtraMin</span><span class="p">,</span>
    <span class="s2">&quot;aXtraMax&quot;</span><span class="p">:</span> <span class="n">aXtraMax</span><span class="p">,</span>
    <span class="s2">&quot;aXtraCount&quot;</span><span class="p">:</span> <span class="n">aXtraCount</span><span class="p">,</span>
    <span class="s2">&quot;aXtraExtra&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">aXtraExtra</span><span class="p">,</span> <span class="n">aXtraHuge</span><span class="p">],</span>
    <span class="s2">&quot;aXtraNestFac&quot;</span><span class="p">:</span> <span class="n">exp_nest</span><span class="p">,</span>
    <span class="s2">&quot;LivPrb&quot;</span><span class="p">:</span> <span class="n">LivPrb</span><span class="p">,</span>
    <span class="s2">&quot;DiscFac&quot;</span><span class="p">:</span> <span class="n">DiscFac_timevary</span><span class="p">,</span>
    <span class="s2">&quot;AgentCount&quot;</span><span class="p">:</span> <span class="n">num_agents</span><span class="p">,</span>
    <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="n">seed</span><span class="p">,</span>
    <span class="s2">&quot;tax_rte&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s2">&quot;vFuncBool&quot;</span><span class="p">:</span> <span class="n">vFuncBool</span><span class="p">,</span>
    <span class="s2">&quot;CubicBool&quot;</span><span class="p">:</span> <span class="n">CubicBool</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up default values for CRRA, DiscFac, and simulation variables in the dictionary</span>
<span class="n">init_consumer_objects</span><span class="p">[</span>
    <span class="s2">&quot;CRRA&quot;</span>
<span class="p">]</span> <span class="o">=</span> <span class="mf">2.00</span>  <span class="c1"># Default coefficient of relative risk aversion (rho)</span>
<span class="c1"># Default intertemporal discount factor (beta)</span>
<span class="n">init_consumer_objects</span><span class="p">[</span><span class="s2">&quot;DiscFac&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.97</span>
<span class="c1"># Aggregate permanent income growth factor</span>
<span class="n">init_consumer_objects</span><span class="p">[</span><span class="s2">&quot;PermGroFacAgg&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">init_consumer_objects</span><span class="p">[</span><span class="s2">&quot;aNrmInitMean&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10.0</span>  <span class="c1"># Mean of log initial assets</span>
<span class="c1"># Standard deviation of log initial assets</span>
<span class="n">init_consumer_objects</span><span class="p">[</span><span class="s2">&quot;aNrmInitStd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="c1"># Mean of log initial permanent income</span>
<span class="n">init_consumer_objects</span><span class="p">[</span><span class="s2">&quot;pLvlInitMean&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">init_consumer_objects</span><span class="p">[</span>
    <span class="s2">&quot;pLvlInitStd&quot;</span>
<span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Standard deviation of log initial permanent income</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make an instance of a lifecycle consumer to be used for estimation</span>
<span class="n">LifeCyclePop</span> <span class="o">=</span> <span class="n">cShksModl</span><span class="o">.</span><span class="n">IndShockConsumerType</span><span class="p">(</span><span class="o">**</span><span class="n">init_consumer_objects</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solve and simulate the model (ignore the &quot;warning&quot; message)</span>
<span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>  <span class="c1"># Obtain consumption rules by age</span>
<span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;cFunc&quot;</span><span class="p">)</span>  <span class="c1"># Expose the consumption rules</span>

<span class="c1"># Which variables do we want to track</span>
<span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">track_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;aNrm&quot;</span><span class="p">,</span> <span class="s2">&quot;aLvl&quot;</span><span class="p">,</span> <span class="s2">&quot;pLvl&quot;</span><span class="p">,</span> <span class="s2">&quot;mNrm&quot;</span><span class="p">,</span> <span class="s2">&quot;cNrm&quot;</span><span class="p">,</span> <span class="s2">&quot;TranShk&quot;</span><span class="p">]</span>

<span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">T_sim</span> <span class="o">=</span> <span class="mi">120</span>  <span class="c1"># Nobody lives to be older than 145 years (=25+120)</span>
<span class="c1"># Construct the age-25 distribution of income and assets</span>
<span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">initialize_sim</span><span class="p">()</span>
<span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>  <span class="c1"># Simulate a population behaving according to this model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;aNrm&#39;: array([[0.15124943, 0.15125731, 0.15126049, ..., 0.15125088, 0.15125539,
         0.151246  ],
        [0.22518609, 0.18215553, 0.35807711, ..., 0.27812983, 0.17667259,
         0.15458877],
        [0.32597743, 0.38337328, 0.37146627, ..., 0.41407619, 0.2350288 ,
         0.25442612],
        ...,
        [0.01608449, 0.35744504, 0.23336433, ..., 0.46517625, 0.49899843,
         0.52070675],
        [0.15126599, 0.40279067, 0.15865312, ..., 0.63411803, 0.59225189,
         0.50505825],
        [0.21086177, 0.43497386, 0.10261234, ..., 0.49429389, 0.5951336 ,
         0.48172896]]),
 &#39;aLvl&#39;: array([[0.16005575, 0.14242219, 0.14242518, ..., 0.16005728, 0.16712597,
         0.13183977],
        [0.2633008 , 0.189512  , 0.31746737, ..., 0.32520573, 0.23338661,
         0.13744097],
        [0.42114459, 0.37555838, 0.31010102, ..., 0.42203979, 0.29234057,
         0.23937429],
        ...,
        [0.01270434, 0.43632293, 0.62845058, ..., 0.70423178, 0.57352318,
         0.65775617],
        [0.16007327, 0.46295571, 0.42725314, ..., 0.90391888, 0.59336343,
         0.67513518],
        [0.22758893, 0.59771874, 0.27633522, ..., 0.84239982, 0.58615115,
         0.65679187]]),
 &#39;pLvl&#39;: array([[1.05822383, 0.94158876, 0.94158876, ..., 1.05822383, 1.10492571,
         0.87169091],
        [1.16925872, 1.04038564, 0.8865894 , ..., 1.16925872, 1.32101196,
         0.88907473],
        [1.29194402, 0.97961543, 0.83480262, ..., 1.0192322 , 1.24385002,
         0.94084007],
        ...,
        [0.78985017, 1.2206714 , 2.6930019 , ..., 1.51390313, 1.14934868,
         1.26319886],
        [1.05822383, 1.14937048, 2.6930019 , ..., 1.42547418, 1.0018768 ,
         1.33674714],
        [1.0793276 , 1.37414863, 2.6930019 , ..., 1.70424892, 0.98490683,
         1.3634054 ]]),
 &#39;mNrm&#39;: array([[1.00001827, 1.00003607, 1.00004326, ..., 1.00002153, 1.00003174,
         1.00001051],
        [1.14105943, 1.06423984, 1.33773072, ..., 1.22438773, 1.05354839,
         1.00744107],
        [1.29330935, 1.37152667, 1.35560327, ..., 1.41203468, 1.15716564,
         1.18806724],
        ...,
        [1.06456208, 1.33262987, 1.34334302, ..., 1.47580996, 1.48887221,
         1.52996964],
        [1.00005568, 1.39107394, 1.24036526, ..., 1.68112185, 1.5896886 ,
         1.50688532],
        [1.11666181, 1.43040404, 1.16341271, ..., 1.51020732, 1.58443432,
         1.47394272]]),
 &#39;cNrm&#39;: array([[0.84876883, 0.84877876, 0.84878277, ..., 0.84877065, 0.84877634,
         0.84876451],
        [0.91587334, 0.88208431, 0.97965361, ..., 0.94625789, 0.87687579,
         0.85285231],
        [0.96733192, 0.98815339, 0.984137  , ..., 0.99795848, 0.92213684,
         0.93364112],
        ...,
        [1.04847759, 0.97518483, 1.10997869, ..., 1.01063371, 0.98987378,
         1.00926289],
        [0.84878969, 0.98828327, 1.08171214, ..., 1.04700382, 0.9974367 ,
         1.00182707],
        [0.90580003, 0.99543018, 1.06080037, ..., 1.01591343, 0.98930072,
         0.99221376]]),
 &#39;TranShk&#39;: array([[1.        , 1.        , 1.        , ..., 1.        , 1.        ,
         1.        ],
        [1.00006632, 0.92323938, 1.1722675 , ..., 1.08339327, 0.92323938,
         0.85470368],
        [1.08339327, 1.1722675 , 0.96390423, ..., 1.08339327, 0.96390423,
         1.0376015 ],
        ...,
        [1.        , 0.92323938, 1.        , ..., 1.08339327, 0.85470368,
         1.0376015 ],
        [1.        , 1.00006632, 1.        , ..., 1.1722675 , 1.00006632,
         1.00006632],
        [0.96390423, 1.08339327, 1.        , ..., 0.96390423, 0.96390423,
         0.96390423]])}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the consumption functions during working life</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Consumption as a function of market resources while working:&quot;</span><span class="p">)</span>
<span class="n">mMin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">mNrmMin</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">T_cycle</span><span class="p">)])</span>
<span class="n">plot_funcs</span><span class="p">(</span><span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">cFunc</span><span class="p">[:</span> <span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">T_retire</span><span class="p">],</span> <span class="n">mMin</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consumption as a function of market resources while working:
</pre></div>
</div>
<img alt="../_images/51ead5cae38c338eb7e8cd93c4e77abe6abd618aecce40a1ab7f771de03b7d72.png" src="../_images/51ead5cae38c338eb7e8cd93c4e77abe6abd618aecce40a1ab7f771de03b7d72.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the saving rate function</span>
<span class="k">def</span> <span class="nf">savRteFunc</span><span class="p">(</span><span class="n">SomeType</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters:</span>
<span class="sd">    ----------</span>
<span class="sd">        SomeType:</span>
<span class="sd">             Agent type that has been solved and simulated.</span>
<span class="sd">        m:</span>
<span class="sd">            normalized market resources of agent</span>
<span class="sd">        t:</span>
<span class="sd">            age of agent (from starting in the workforce)</span>


<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">        savRte: float</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">inc</span> <span class="o">=</span> <span class="p">(</span><span class="n">SomeType</span><span class="o">.</span><span class="n">Rfree</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
        <span class="n">m</span> <span class="o">-</span> <span class="mf">1.0</span>
    <span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span>  <span class="c1"># Normalized by permanent labor income</span>
    <span class="n">cns</span> <span class="o">=</span> <span class="n">SomeType</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">cFunc</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>  <span class="c1"># Consumption (normalized)</span>
    <span class="n">sav</span> <span class="o">=</span> <span class="n">inc</span> <span class="o">-</span> <span class="n">cns</span>  <span class="c1"># Flow of saving this period</span>
    <span class="n">savRte</span> <span class="o">=</span> <span class="n">sav</span> <span class="o">/</span> <span class="n">inc</span>  <span class="c1"># Saving Rate</span>
    <span class="k">return</span> <span class="n">savRte</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a matrix gathering useful data:</span>
<span class="c1"># &#39;t_now&#39;, &#39;aNrm_hist&#39;, &#39;cNrm_hist&#39;, employment-status in date t and date t-1,</span>
<span class="c1"># aLvlGro_hist, Saving rate</span>

<span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">T_cycle</span>
<span class="n">giant_list</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">w</span><span class="p">)]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">h</span><span class="p">)]</span>
<span class="n">savRte_list</span> <span class="o">=</span> <span class="p">[]</span>


<span class="c1"># Suppress some disturbing but harmless warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">T_cycle</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="c1"># aLvlGro[0] = 0 # set the first growth rate to 0, since there is no data for period 0</span>
    <span class="n">aLvlGroNow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
        <span class="p">(</span><span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;aNrm&quot;</span><span class="p">][</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;pLvl&quot;</span><span class="p">][</span><span class="n">t</span><span class="p">])</span>
        <span class="o">/</span> <span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;aNrm&quot;</span><span class="p">][</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="o">*</span> <span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;pLvl&quot;</span><span class="p">][</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="p">)</span>  <span class="c1"># (10000,)</span>

    <span class="c1"># Call the saving rate function defined above</span>
    <span class="n">savRte</span> <span class="o">=</span> <span class="n">savRteFunc</span><span class="p">(</span><span class="n">LifeCyclePop</span><span class="p">,</span> <span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;mNrm&quot;</span><span class="p">][</span><span class="n">t</span><span class="p">],</span> <span class="n">t</span><span class="p">)</span>

    <span class="n">savRte_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">savRte</span><span class="p">)</span>  <span class="c1"># Add this period&#39;s saving rate to the list</span>

    <span class="c1"># Create elements of matrix list</span>
    <span class="n">matrix_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)]</span>
    <span class="n">matrix_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>
    <span class="n">matrix_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;aNrm&quot;</span><span class="p">][</span><span class="n">t</span><span class="p">]</span>
    <span class="n">matrix_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;cNrm&quot;</span><span class="p">][</span><span class="n">t</span><span class="p">]</span>
    <span class="n">matrix_list</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;TranShk&quot;</span><span class="p">][</span><span class="n">t</span><span class="p">]</span>
    <span class="n">matrix_list</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;TranShk&quot;</span><span class="p">][</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">matrix_list</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">aLvlGroNow</span>
    <span class="n">matrix_list</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">savRte</span>

    <span class="n">giant_list</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">matrix_list</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Construct the level of assets A from a*p where a is the ratio to permanent income p</span>
<span class="c1"># Remember 41 is &quot;years after entering workforce&quot; (=age 25); 66 is the year right after retirement</span>
<span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;aLvl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;aNrm&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;pLvl&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">aGro41</span> <span class="o">=</span> <span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;aLvl&quot;</span><span class="p">][</span><span class="mi">41</span><span class="p">]</span> <span class="o">/</span> <span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;aLvl&quot;</span><span class="p">][</span><span class="mi">40</span><span class="p">]</span>
<span class="n">aGro41NoU</span> <span class="o">=</span> <span class="n">aGro41</span><span class="p">[</span>
    <span class="n">aGro41</span><span class="p">[:]</span> <span class="o">&gt;</span> <span class="mf">0.2</span>
<span class="p">]</span>  <span class="c1"># Throw out extreme outliers; don&#39;t want growth rates relative to 0 income!</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the (truncated) distribution of growth rates of wealth between age 65 and 66 (=25 + 41)</span>

<span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">aGro41NoU</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/013f53fed4bb551036b5173407e8df768afb0bffbaaa744cc2c390b850461353.png" src="../_images/013f53fed4bb551036b5173407e8df768afb0bffbaaa744cc2c390b850461353.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="saving-rates-and-lifetime-income-growth">
<h1>Saving Rates and Lifetime Income Growth<a class="headerlink" href="#saving-rates-and-lifetime-income-growth" title="Permalink to this heading">#</a></h1>
<p>We are interested in how income growth over the lifetime of the agent affects their saving rate and asset ratio <span class="math notranslate nohighlight">\(a=A/P\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cumulative_income_first_half</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
    <span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;pLvl&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;TranShk&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span> <span class="p">:],</span> <span class="mi">0</span>
<span class="p">)</span>
<span class="n">cumulative_income_second_half</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
    <span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;pLvl&quot;</span><span class="p">][</span><span class="mi">20</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;TranShk&quot;</span><span class="p">][</span><span class="mi">20</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span> <span class="p">:],</span>
    <span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">lifetime_growth</span> <span class="o">=</span> <span class="n">cumulative_income_second_half</span> <span class="o">/</span> <span class="n">cumulative_income_first_half</span>

<span class="n">t</span> <span class="o">=</span> <span class="mi">39</span>
<span class="n">vigntiles</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">lifetime_growth</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">savRte</span> <span class="o">=</span> <span class="n">savRteFunc</span><span class="p">(</span><span class="n">LifeCyclePop</span><span class="p">,</span> <span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;mNrm&quot;</span><span class="p">][</span><span class="n">t</span><span class="p">],</span> <span class="n">t</span><span class="p">)</span>
<span class="n">savRtgueseByVigtile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">assetsByVigtile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">assetsNrmByVigtile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">savRteByVigtile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">savRteByVigtile</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">savRte</span><span class="p">[</span><span class="n">vigntiles</span> <span class="o">==</span> <span class="n">i</span><span class="p">])</span>
    <span class="n">assetsByVigtile</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;aLvl&quot;</span><span class="p">][</span><span class="n">t</span><span class="p">][</span><span class="n">vigntiles</span> <span class="o">==</span> <span class="n">i</span><span class="p">])</span>
    <span class="n">assetsNrmByVigtile</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">LifeCyclePop</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;aNrm&quot;</span><span class="p">][</span><span class="n">t</span><span class="p">][</span><span class="n">vigntiles</span> <span class="o">==</span> <span class="n">i</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)),</span> <span class="n">savRteByVigtile</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Saving Rate at age 65, by Vigntile of Lifetime Income Growth&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Vigntile of Lifetime Income Growth&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Savings Rate&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)),</span> <span class="n">assetsByVigtile</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Assets at age 65, by Vigntile of Lifetime Income Growth&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Vigntile of Lifetime Income Growth&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Assets&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)),</span> <span class="n">assetsNrmByVigtile</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Normalized Assets at age 65, by Vigntile of Lifetime Income Growth&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Vigntile of Lifetime Income Growth&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Normalized Assets&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Normalized Assets&#39;)
</pre></div>
</div>
<img alt="../_images/f38f1557d4a72e490b9d4b8da7d99d8a9d4e0e316b6445b9de97d55aa05d2f9d.png" src="../_images/f38f1557d4a72e490b9d4b8da7d99d8a9d4e0e316b6445b9de97d55aa05d2f9d.png" />
<img alt="../_images/ec1e38adf5e2126bd9b17a128c66e986d0d7735789475244721e4c5adf730fbf.png" src="../_images/ec1e38adf5e2126bd9b17a128c66e986d0d7735789475244721e4c5adf730fbf.png" />
<img alt="../_images/6d9367b380465ac9d63b60f6d1a619e87410ac77f5b076cffa0d97c741f05a1c.png" src="../_images/6d9367b380465ac9d63b60f6d1a619e87410ac77f5b076cffa0d97c741f05a1c.png" />
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "econ-ark/DemARK",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="LC-Model-Expected-Vs-Realized-Income-Growth.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Expectated vs Realized Income Growth in A Standard Life Cycle Model</p>
      </div>
    </a>
    <a class="right-next"
       href="Lucas-Asset-Pricing-Model.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lucas Asset Pricing Model</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">The Life Cycle Model: Theory vs Data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-rates-and-lifetime-income-growth">Saving Rates and Lifetime Income Growth</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Econ-ARK Team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>