

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Micro- and Macroeconomic Implications of Very Impatient Households &#8212; DemARK</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/Micro-and-Macro-Implications-of-Very-Impatient-HHs';</script>
    <link rel="shortcut icon" href="../_static/econ-ark-logo-small.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Spending on Nondurables During the Great Recession" href="Nondurables-During-Great-Recession.html" />
    <link rel="prev" title="The MPC out of Credit vs the MPC Out of Income" href="MPC-Out-of-Credit-vs-MPC-Out-of-Income.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/econ-ark-logo.png" class="logo__image only-light" alt="DemARK - Home"/>
    <script>document.write(`<img src="../_static/econ-ark-logo.png" class="logo__image only-dark" alt="DemARK - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    DemARK
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Alternative-Combos-Of-Parameter-Values.html">Alternative Combinations of Parameter Values</a></li>


<li class="toctree-l1"><a class="reference internal" href="ChangeLiqConstr.html">What Happens To the Consumption Function When A Liquidity Constraint is Tightened?</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chinese-Growth.html">Do Precautionary Motives Explain China’s High Saving Rate?</a></li>
<li class="toctree-l1"><a class="reference internal" href="DCEGM-Upper-Envelope.html">DCEGM Upper Envelope</a></li>






<li class="toctree-l1"><a class="reference internal" href="DiamondOLG.html">The Diamond OLG Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="FisherTwoPeriod.html">The Fisher Two-Period Optimal Consumption Problem</a></li>

<li class="toctree-l1"><a class="reference internal" href="Gentle-Intro-To-HARK-Buffer-Stock-Model.html">A Gentle Introduction to HARK: Buffer Stock Saving</a></li>
<li class="toctree-l1"><a class="reference internal" href="Gentle-Intro-To-HARK-PerfForesightCRRA.html">A Gentle Introduction to HARK: The Perfect Foresight Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="Harmenberg-Aggregation.html">A Demonstration of the Harmenberg (2021) Aggregation Method</a></li>







<li class="toctree-l1"><a class="reference internal" href="IncExpectationExample.html">The Persistent Shock Model and Income Expectations</a></li>
<li class="toctree-l1"><a class="reference internal" href="KeynesFriedmanModigliani.html">Introduction: Keynes, Friedman, Modigliani</a></li>
<li class="toctree-l1"><a class="reference internal" href="LC-Model-Expected-Vs-Realized-Income-Growth.html">Expectated vs Realized Income Growth in A Standard Life Cycle Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="LifeCycleModelTheoryVsData.html">The Life Cycle Model: Theory vs Data</a></li>

<li class="toctree-l1"><a class="reference internal" href="Lucas-Asset-Pricing-Model.html">Lucas Asset Pricing Model</a></li>





<li class="toctree-l1"><a class="reference internal" href="MPC-Out-of-Credit-vs-MPC-Out-of-Income.html">The MPC out of Credit vs the MPC Out of Income</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Micro- and Macroeconomic Implications of Very Impatient Households</a></li>

<li class="toctree-l1"><a class="reference internal" href="Nondurables-During-Great-Recession.html">Spending on Nondurables During the Great Recession</a></li>
<li class="toctree-l1"><a class="reference internal" href="PerfForesightCRRA-Approximation.html">Perfect Foresight CRRA Model - Approximation</a></li>
<li class="toctree-l1"><a class="reference internal" href="PerfForesightCRRA-SavingRate.html">Perfect Foresight CRRA Model - Saving Rate</a></li>
<li class="toctree-l1"><a class="reference internal" href="Structural-Estimates-From-Empirical-MPCs-Fagereng-et-al.html">Making Structural Estimates From Empirical Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="TractableBufferStock-Interactive.html">The Tractable Buffer Stock Model</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/econ-ark/DemARK/master?urlpath=lab/tree/notebooks/Micro-and-Macro-Implications-of-Very-Impatient-HHs.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://hub.econ-ark.org/hub/user-redirect/git-pull?repo=https%3A//github.com/econ-ark/DemARK&urlpath=lab/tree/DemARK/notebooks/Micro-and-Macro-Implications-of-Very-Impatient-HHs.ipynb&branch=master" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/econ-ark/DemARK/blob/master/notebooks/Micro-and-Macro-Implications-of-Very-Impatient-HHs.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/Micro-and-Macro-Implications-of-Very-Impatient-HHs.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Micro- and Macroeconomic Implications of Very Impatient Households</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Micro- and Macroeconomic Implications of Very Impatient Households</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calibrating-a-basic-version-of-cstwmpc">Calibrating a Basic Version of cstwMPC</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-an-ex-ante-distribution-of-heterogeneous-agents">Creating an ex-ante distribution of heterogeneous agents</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#method-1-brute-force-approach">Method 1: “Brute force” approach</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#method-2-the-new-agentpopulation-class">Method 2: The new <code class="docutils literal notranslate"><span class="pre">AgentPopulation</span></code> class</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-and-simulating-the-baseline-agents">Solving and Simulating the Baseline Agents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-for-the-brute-force-approach">1. Solution for the “brute force” approach</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-using-the-agentpopulation-class">2. Solution using the <code class="docutils literal notranslate"><span class="pre">AgentPopulation</span></code> class</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-lorenz-curve">Plotting the Lorenz Curve</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-the-lorenz-distance-at-targets">Calculating the Lorenz Distance at Targets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-distribution-of-the-marginal-propensity-to-consume">The Distribution Of the Marginal Propensity to Consume</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mpc-distribution-from-the-brute-force-approach">1. MPC distribution from the “brute force” approach</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mpc-distribution-from-the-agentpopulation-approach">2. MPC distribution from the <code class="docutils literal notranslate"><span class="pre">AgentPopulation</span></code> approach</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-very-impatient-households">Adding Very Impatient Households</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="micro-and-macroeconomic-implications-of-very-impatient-households">
<h1>Micro- and Macroeconomic Implications of Very Impatient Households<a class="headerlink" href="#micro-and-macroeconomic-implications-of-very-impatient-households" title="Permalink to this heading">#</a></h1>
<p style="text-align: center;"><small><small><small>Generator: QuARK-make/notebooks_byname</small></small></small></p>
<p><a class="reference external" href="https://econ-ark.org/materials/micro-and-macro-implications-of-very-impatient-hhs#launch"><img alt="badge" src="https://img.shields.io/badge/Launch%20using%20-Econ--ARK-blue" /></a></p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>Buffer stock saving models of the kind implemented in <span class="math notranslate nohighlight">\(\texttt{ConsIndShockType}\)</span> say that, if a standard <a class="reference external" href="https://econ-ark.github.io/BufferStockTheory/#GICRaw">‘Growth Impatience Condition’</a>, holds:</p>
<div class="amsmath math notranslate nohighlight" id="equation-45a525b7-6250-4dba-8e67-4cfefcaf104e">
<span class="eqno">(21)<a class="headerlink" href="#equation-45a525b7-6250-4dba-8e67-4cfefcaf104e" title="Permalink to this equation">#</a></span>\[\begin{eqnarray}
\newcommand{\Rfree}{\mathsf{R}}\newcommand{\DiscFac}{\beta}\newcommand{\PermGroFac}{\Gamma}\newcommand{\PermShk}{\psi}\newcommand{\CRRA}{\rho}
\left(\frac{(\Rfree\DiscFac)^{1/\CRRA}\mathbb{E}[\PermShk^{-1}]}{\PermGroFac}\right) &amp; &lt; &amp; 1
\end{eqnarray}\]</div>
<p>then the <em>ratio</em> of asets <span class="math notranslate nohighlight">\(\newcommand{\aLev}{\mathbf{a}}\aLev\)</span> to permanent income <span class="math notranslate nohighlight">\(\newcommand{\pLev}{\mathbf{p}}\pLev\)</span>, <span class="math notranslate nohighlight">\(a=\aLev/\pLev\)</span>, has a target value <span class="math notranslate nohighlight">\(\newcommand{\aTarg}{\check{a}}\aTarg\)</span> that depends on the consumer’s preferences (relative risk aversion <span class="math notranslate nohighlight">\(\CRRA\)</span>, time preference <span class="math notranslate nohighlight">\(\DiscFac\)</span>) and circumstances (interest factor <span class="math notranslate nohighlight">\(\Rfree\)</span>, growth factor <span class="math notranslate nohighlight">\(\PermGroFac\)</span>, uncertainty about permanent income shocks <span class="math notranslate nohighlight">\(\sigma^{2}_{\PermShk}\)</span>).</p>
<p>If everyone had identical preferences and everyone were at their target <span class="math notranslate nohighlight">\(\check{a}\)</span>, then inequality in the level of <span class="math notranslate nohighlight">\(\aLev\)</span> would be exactly the same as inequality in <span class="math notranslate nohighlight">\(\pLev\)</span>.</p>
<p><a class="reference external" href="https://www.econ2.jhu.edu/people/ccarroll/papers/cstwMPC">“The Distribution of Wealth and the Marginal Propensity to Consume”</a> (Carroll, Slacalek, Tokuoka, and White 2017; hereafter: “cstwMPC”) shows that, when such a model is simulated and agents draw their idiosyncratic shocks (so, agents are <em>ex post</em> heterogeneous – see the definition in <a class="reference external" href="http://github.com/econ-ark/PARK/tree/master/Intro-To-HARK.pdf">Intro-To-HARK</a>) – asset inequality is indeed close to <span class="math notranslate nohighlight">\(\pLev\)</span> inequality even though everyone is not always at exactly their target <span class="math notranslate nohighlight">\(a\)</span>.</p>
<p>But a large body of evidence shows that <em>actual</em> inequality in assets is much greater than <em>actual</em> inequality in permanent income.  Thus, to make a model that qualifies as what cstwMPC call a ‘serious’ microfounded macro model of consumption (one that matches the key facts <em>theory says</em> should be first-order important), the model must be modified to incorporate some form of <em>ex ante</em> heterogeneity: That is, there must be differences across people in <span class="math notranslate nohighlight">\(\DiscFac\)</span> or <span class="math notranslate nohighlight">\(\Rfree\)</span> or <span class="math notranslate nohighlight">\(\CRRA\)</span> or <span class="math notranslate nohighlight">\(\PermGroFac\)</span> or <span class="math notranslate nohighlight">\(\sigma^{2}_{\PermShk}\)</span>.</p>
<p>The most transparent and simplest of these to change is the time preference factor <span class="math notranslate nohighlight">\(\beta\)</span>.  So that is what the paper does.  The main results are:</p>
<ol class="arabic simple">
<li><p>The distribution of <span class="math notranslate nohighlight">\(\beta\)</span> need not be particularly wide to match the extreme concentration of wealth: roughly 0.91 to 0.98 (annual); that is, the most impatient person discounts the future about 6 percentage points more per year than the most patient agent agent</p></li>
<li><p>With such a distribution of <span class="math notranslate nohighlight">\(\beta\)</span>, simulated agents’ (annual) marginal propensity to consume (MPC) from transitory income shocks to income matches large body of microeconomic evidence that typically finds evidence of MPC’s in the range of 0.2 to 0.6.  This is much better than RA macro models that typically yield MPC’s in the range of 0.01 to 0.05.</p></li>
</ol>
<p>While the most impatient agents in the cstwMPC model have fairly high MPCs (~0.6 annual), there is microeconomic evidence that a significant fraction of households have <em>even higher</em> MPCs than the model predicts, especially at the quarterly frequency.  This group of households is commonly referred to as “hand-to-mouth” – they consume most of their transitory shocks to income not too long after they receive them (mostly within a quarter).  There are several reasons why a household could be hand-to-mouth, but one plausible explanation is that these households are <em>even more impatient</em> than estimated by cstwMPC for the most impatient agent.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This cell does some setup and imports generic tools used to produce the figures</span>

<span class="kn">from</span> <span class="nn">HARK.utilities</span> <span class="kn">import</span> <span class="n">get_lorenz_shares</span><span class="p">,</span> <span class="n">get_percentiles</span>
<span class="kn">from</span> <span class="nn">HARK.datasets</span> <span class="kn">import</span> <span class="n">load_SCF_wealth_weights</span>
<span class="kn">from</span> <span class="nn">HARK.distribution</span> <span class="kn">import</span> <span class="n">Uniform</span>
<span class="kn">from</span> <span class="nn">HARK.ConsumptionSaving.ConsIndShockModel</span> <span class="kn">import</span> <span class="n">IndShockConsumerType</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">distutils.spawn</span> <span class="kn">import</span> <span class="n">find_executable</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">IPython</span> <span class="kn">import</span> <span class="n">get_ipython</span>  <span class="c1"># In case it was run from python instead of ipython</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">Generator</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Is this notebook the master or is it generated?</span>
<span class="c1"># Import related generic python packages</span>

<span class="c1"># Set how many digits past the decimal point should be printed?</span>


<span class="k">def</span> <span class="nf">mystr</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">decfmt4</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">decfmt3</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">decfmt2</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">decfmt1</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{:.1f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>


<span class="c1"># This is a jupytext paired notebook that autogenerates BufferStockTheory.py</span>
<span class="c1"># which can be executed from a terminal command line via &quot;ipython BufferStockTheory.py&quot;</span>
<span class="c1"># But a terminal does not permit inline figures, so we need to test jupyter vs terminal</span>
<span class="c1"># Google &quot;how can I check if code is executed in the ipython notebook&quot;</span>


<span class="k">def</span> <span class="nf">in_ipynb</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">get_ipython</span><span class="p">()))</span>
            <span class="o">==</span> <span class="s2">&quot;&lt;class &#39;ipykernel.zmqshell.ZMQInteractiveShell&#39;&gt;&quot;</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>


<span class="c1"># Determine whether to make the figures inline (for spyder or jupyter)</span>
<span class="c1"># vs whatever is the automatic setting that will apply if run from the terminal</span>
<span class="k">if</span> <span class="n">in_ipynb</span><span class="p">():</span>
    <span class="c1"># %matplotlib inline generates a syntax error when run from the shell</span>
    <span class="c1"># so do this instead</span>
    <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_line_magic</span><span class="p">(</span><span class="s2">&quot;matplotlib&quot;</span><span class="p">,</span> <span class="s2">&quot;inline&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_line_magic</span><span class="p">(</span><span class="s2">&quot;matplotlib&quot;</span><span class="p">,</span> <span class="s2">&quot;auto&quot;</span><span class="p">)</span>

<span class="c1"># Import the plot-figure library matplotlib</span>


<span class="c1"># In order to use LaTeX to manage all text layout in our figures, we import rc settings from matplotlib.</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s2">&quot;font&quot;</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s2">&quot;serif&quot;</span><span class="p">)</span>

<span class="c1"># LaTeX is huge and takes forever to install on mybinder</span>
<span class="c1"># so if it is not installed then do not use it</span>

<span class="n">iflatexExists</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">if</span> <span class="n">find_executable</span><span class="p">(</span><span class="s2">&quot;latex&quot;</span><span class="p">):</span>
    <span class="n">iflatexExists</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="n">iflatexExists</span><span class="p">)</span>

<span class="c1"># The warnings package allows us to ignore some harmless but alarming warning messages</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="calibrating-a-basic-version-of-cstwmpc">
<h2>Calibrating a Basic Version of cstwMPC<a class="headerlink" href="#calibrating-a-basic-version-of-cstwmpc" title="Permalink to this heading">#</a></h2>
<p>To get started, let’s reproduce a simplified version of the main results from cstwMPC.</p>
<p>In cstwMPC, the authors calibrated nearly all of the model parameters– risk aversion, income shock process, etc– to commonly used or previously estimated values.  The only parameter to be estimated is the distribution of <span class="math notranslate nohighlight">\(\beta\)</span>.  cstwMPC assumed that <span class="math notranslate nohighlight">\(\beta\)</span> is uniformly distributed on <span class="math notranslate nohighlight">\([\grave{\beta}-\nabla,\grave{\beta}+\nabla]\)</span>, approximated by a seven point distribution.</p>
<p>Their estimation procedure seeks the values of <span class="math notranslate nohighlight">\(\grave{\beta}\)</span> and <span class="math notranslate nohighlight">\(\nabla\)</span> that generate a simulated distribution of wealth that best matches empirical U.S. data.  Their definition of “best match” has two aspects:</p>
<ol class="arabic simple">
<li><p>The simulated aggregate capital-to-income ratio matches the true U.S. value.</p></li>
<li><p>The sum of squared distances between the simulated and empirical Lorenz curves (at the 20th, 40th, 60th, and 80th percentiles) is minimized (conditional on item 1).</p></li>
</ol>
<p>cstwMPC’s target empirical moments are a capital-to-income ratio of 10.26 and cumulative wealth shares as given in the table below.  Yes, you are reading the table correctly: The “poorest” 80 percent of households own 17.5 percent of wealth.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Net worth percentile</p></th>
<th class="head text-center"><p>Cumulative wealth share</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>20th</p></td>
<td class="text-center"><p>-0.2%</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>40th</p></td>
<td class="text-center"><p>1.0%</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>60th</p></td>
<td class="text-center"><p>5.5%</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>80th</p></td>
<td class="text-center"><p>17.5%</p></td>
</tr>
</tbody>
</table>
<p>To reproduce their basic results, we must import an <span class="math notranslate nohighlight">\(\texttt{AgentType}\)</span> subclass and define a dictionary with calibrated parameters identical to those in the paper.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import IndShockConsumerType</span>

<span class="c1"># Define a dictionary with calibrated parameters</span>
<span class="n">cstwMPC_calibrated_parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;CRRA&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># Coefficient of relative risk aversion</span>
    <span class="s2">&quot;Rfree&quot;</span><span class="p">:</span> <span class="mf">1.01</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">160.0</span><span class="p">),</span>  <span class="c1"># Survival probability,</span>
    <span class="c1"># Permanent income growth factor (no perm growth),</span>
    <span class="s2">&quot;PermGroFac&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.000</span><span class="o">**</span><span class="mf">0.25</span><span class="p">],</span>
    <span class="s2">&quot;PermGroFacAgg&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="s2">&quot;BoroCnstArt&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s2">&quot;CubicBool&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;vFuncBool&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;PermShkStd&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">(</span><span class="mf">0.01</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">/</span> <span class="mi">11</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
    <span class="p">],</span>  <span class="c1"># Standard deviation of permanent shocks to income</span>
    <span class="s2">&quot;PermShkCount&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>  <span class="c1"># Number of points in permanent income shock grid</span>
    <span class="s2">&quot;TranShkStd&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">(</span><span class="mf">0.01</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
    <span class="p">],</span>  <span class="c1"># Standard deviation of transitory shocks to income,</span>
    <span class="s2">&quot;TranShkCount&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>  <span class="c1"># Number of points in transitory income shock grid</span>
    <span class="s2">&quot;UnempPrb&quot;</span><span class="p">:</span> <span class="mf">0.07</span><span class="p">,</span>  <span class="c1"># Probability of unemployment while working</span>
    <span class="s2">&quot;IncUnemp&quot;</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">,</span>  <span class="c1"># Unemployment benefit replacement rate</span>
    <span class="s2">&quot;UnempPrbRet&quot;</span><span class="p">:</span> <span class="mf">0.07</span><span class="p">,</span>
    <span class="s2">&quot;IncUnempRet&quot;</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">,</span>
    <span class="s2">&quot;aXtraMin&quot;</span><span class="p">:</span> <span class="mf">0.00001</span><span class="p">,</span>  <span class="c1"># Minimum end-of-period assets in grid</span>
    <span class="s2">&quot;aXtraMax&quot;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>  <span class="c1"># Maximum end-of-period assets in grid</span>
    <span class="s2">&quot;aXtraCount&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>  <span class="c1"># Number of points in assets grid</span>
    <span class="s2">&quot;aXtraExtra&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">],</span>
    <span class="s2">&quot;aXtraNestFac&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>  <span class="c1"># Number of times to &#39;exponentially nest&#39; when constructing assets grid</span>
    <span class="s2">&quot;LivPrb&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">160.0</span><span class="p">],</span>  <span class="c1"># Survival probability</span>
    <span class="s2">&quot;DiscFac&quot;</span><span class="p">:</span> <span class="mf">0.97</span><span class="p">,</span>  <span class="c1"># Default intertemporal discount factor; dummy value, will be overwritten</span>
    <span class="s2">&quot;cycles&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;T_cycle&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;T_retire&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="c1"># Number of periods to simulate (idiosyncratic shocks model, perpetual youth)</span>
    <span class="s2">&quot;T_sim&quot;</span><span class="p">:</span> <span class="mi">1200</span><span class="p">,</span>
    <span class="s2">&quot;T_age&quot;</span><span class="p">:</span> <span class="mi">400</span><span class="p">,</span>
    <span class="s2">&quot;IndL&quot;</span><span class="p">:</span> <span class="mf">10.0</span> <span class="o">/</span> <span class="mf">9.0</span><span class="p">,</span>  <span class="c1"># Labor supply per individual (constant),</span>
    <span class="s2">&quot;aNrmInitMean&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.00001</span><span class="p">),</span>
    <span class="s2">&quot;aNrmInitStd&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s2">&quot;pLvlInitMean&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s2">&quot;pLvlInitStd&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s2">&quot;AgentCount&quot;</span><span class="p">:</span> <span class="mi">10000</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Start with importing the predefined dictionaries for agent types from the HARK toolkit. Then only show the parameters that are actually different from the imported dictionary.</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="creating-an-ex-ante-distribution-of-heterogeneous-agents">
<h1>Creating an ex-ante distribution of heterogeneous agents<a class="headerlink" href="#creating-an-ex-ante-distribution-of-heterogeneous-agents" title="Permalink to this heading">#</a></h1>
<p>Now let’s make several instances of our class of agents and give them different values of <span class="math notranslate nohighlight">\(\beta\)</span>, following cstwMPC’s estimated distribution.  In our specification of interest, we will use <span class="math notranslate nohighlight">\(\grave{\beta}=0.9855583\)</span> and <span class="math notranslate nohighlight">\(\nabla = 0.0085\)</span>.</p>
<p>NB: Reported parameter estimates in cstwMPC use a model with aggregate shocks and wage and interest rates determined dynamically (a heterogeneous agents DSGE model); this is the <span class="math notranslate nohighlight">\(\texttt{AggShockConsumerType}\)</span> in HARK.  The estimated parameters are slightly different in this exercise, as we are ignoring general equilibrium aspects and only using the <span class="math notranslate nohighlight">\(\texttt{IndShockConsumerType}\)</span></p>
<section id="method-1-brute-force-approach">
<h2>Method 1: “Brute force” approach<a class="headerlink" href="#method-1-brute-force-approach" title="Permalink to this heading">#</a></h2>
<p>There are two methods for accomplishing this. The first is a more “brute force” approach: We specify a uniform distribution and discretize it for the number of household types we would like to see in the model. From there, We place each of the household types with a different time preference factor in a list. Finally, a for-loop is used to compute the solution for each household’s optimization problem.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This cell constructs seven instances of IndShockConsumerType with different discount factors</span>

<span class="n">BaselineType</span> <span class="o">=</span> <span class="n">IndShockConsumerType</span><span class="p">(</span><span class="o">**</span><span class="n">cstwMPC_calibrated_parameters</span><span class="p">)</span>

<span class="c1"># Specify the distribution of the discount factor</span>
<span class="n">num_types</span> <span class="o">=</span> <span class="mi">7</span>  <span class="c1"># number of types we want</span>
<span class="n">DiscFac_mean</span> <span class="o">=</span> <span class="mf">0.9855583</span>  <span class="c1"># center of beta distribution</span>
<span class="n">DiscFac_spread</span> <span class="o">=</span> <span class="mf">0.0085</span>  <span class="c1"># spread of beta distribution</span>

<span class="c1"># Here&#39;s how to use the tools to create time preference heterogeneity manually</span>

<span class="n">DiscFac_dstn</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Uniform</span><span class="p">(</span><span class="n">DiscFac_mean</span> <span class="o">-</span> <span class="n">DiscFac_spread</span><span class="p">,</span> <span class="n">DiscFac_mean</span> <span class="o">+</span> <span class="n">DiscFac_spread</span><span class="p">)</span>
    <span class="o">.</span><span class="n">discretize</span><span class="p">(</span><span class="n">num_types</span><span class="p">)</span>
    <span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="p">)</span>

<span class="n">MyTypes</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># initialize an empty list to hold our consumer types</span>
<span class="k">for</span> <span class="n">nn</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_types</span><span class="p">):</span>
    <span class="c1"># Now create the types, and append them to the list MyTypes</span>
    <span class="n">NewType</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">BaselineType</span><span class="p">)</span>
    <span class="n">NewType</span><span class="o">.</span><span class="n">DiscFac</span> <span class="o">=</span> <span class="n">DiscFac_dstn</span><span class="p">[</span><span class="n">nn</span><span class="p">]</span>
    <span class="n">NewType</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">nn</span>  <span class="c1"># give each consumer type a different RNG seed</span>
    <span class="n">MyTypes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NewType</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="method-2-the-new-agentpopulation-class">
<h2>Method 2: The new <code class="docutils literal notranslate"><span class="pre">AgentPopulation</span></code> class<a class="headerlink" href="#method-2-the-new-agentpopulation-class" title="Permalink to this heading">#</a></h2>
<p>The second approach incorporates a new class defined in the  HARK toolkit: <code class="docutils literal notranslate"><span class="pre">AgentPopulation</span></code>. This class will create a new iterable object <code class="docutils literal notranslate"><span class="pre">AgentPopulation</span></code>, which takes two arguments. The first is the dictionary which defines the AgentType. The second is a distribution over the parameter value for which the user would like to see ex-ante heterogeneity in. From there, the <code class="docutils literal notranslate"><span class="pre">approx_distributions</span></code> method is called on the object to discretize the distribution given the specified number of discrete points. Finally, the <code class="docutils literal notranslate"><span class="pre">create_distributed_agents</span></code> method is called to create the distribution of agents, for which the standard solution method calls can be used to solve each agents problem.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This cell constructs seven instances of IndShockConsumerType with different discount factors</span>

<span class="kn">from</span> <span class="nn">HARK.core</span> <span class="kn">import</span> <span class="n">AgentPopulation</span>

<span class="c1"># Specify the distribution of the discount factor</span>
<span class="n">num_types</span> <span class="o">=</span> <span class="mi">7</span>  <span class="c1"># number of types we want</span>
<span class="n">DiscFac_mean</span> <span class="o">=</span> <span class="mf">0.9855583</span>  <span class="c1"># center of beta distribution</span>
<span class="n">DiscFac_spread</span> <span class="o">=</span> <span class="mf">0.0085</span>  <span class="c1"># spread of beta distribution</span>

<span class="n">cstwMPC_calibrated_parameters</span><span class="p">[</span><span class="s2">&quot;DiscFac&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Uniform</span><span class="p">(</span>
    <span class="n">DiscFac_mean</span> <span class="o">-</span> <span class="n">DiscFac_spread</span><span class="p">,</span> <span class="n">DiscFac_mean</span> <span class="o">+</span> <span class="n">DiscFac_spread</span>
<span class="p">)</span>

<span class="n">SubPops</span> <span class="o">=</span> <span class="n">AgentPopulation</span><span class="p">(</span><span class="n">IndShockConsumerType</span><span class="p">,</span> <span class="n">cstwMPC_calibrated_parameters</span><span class="p">)</span>
<span class="n">SubPops</span><span class="o">.</span><span class="n">approx_distributions</span><span class="p">({</span><span class="s2">&quot;DiscFac&quot;</span><span class="p">:</span> <span class="n">num_types</span><span class="p">})</span>
<span class="n">SubPops</span><span class="o">.</span><span class="n">create_distributed_agents</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="solving-and-simulating-the-baseline-agents">
<h2>Solving and Simulating the Baseline Agents<a class="headerlink" href="#solving-and-simulating-the-baseline-agents" title="Permalink to this heading">#</a></h2>
<p>Now let’s solve and simulate each of our types of agents.  If you look in the parameter dictionary (or at any of the agent objects themselves), you will see that each one has an <span class="math notranslate nohighlight">\(\texttt{AgentCount}\)</span> attribute of 10000. That is, these seven ex ante heterogeneous types each represent ten thousand individual agents that will experience ex post heterogeneity when they draw different income (and mortality) shocks over time.</p>
<p>In the code block below, fill in the contents of the loop to solve and simulate each agent type for many periods.  To do this, you should invoke the methods <span class="math notranslate nohighlight">\(\texttt{solve}\)</span>, <span class="math notranslate nohighlight">\(\texttt{initialize\_sim}\)</span>, and <span class="math notranslate nohighlight">\(\texttt{simulate}\)</span> in that order.  Simulating for 1200 quarters (300 years) will approximate the long run distribution of wealth in the population.</p>
<p>After solving the model, we will check that the aggregate level of capital (total assets held by all households) to income ratio equals what we expected it would be. This will serve as a verification that the code is written correctly. To do this, we combine the asset holdings of all types, take the mean, and compare it to the desired capital to income ratio of 10.26.</p>
<p>NB: Because there is no permanent income growth in this model, all shocks are mean one and idiosyncratic, and we have many agents, aggregate or average income is 1.0.</p>
<section id="solution-for-the-brute-force-approach">
<h3>1. Solution for the “brute force” approach<a class="headerlink" href="#solution-for-the-brute-force-approach" title="Permalink to this heading">#</a></h3>
<p>Here is the output for the solution to the first approach to the problem, as well as a computation of the mean level of assets across the agent types. As you can see, the model does a good job of matching the aggregate capital-to-output ratio found in the data, as cited by Carroll et al. (2017).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Progress bar keeps track interactively of how many have been made</span>
<span class="k">for</span> <span class="n">ThisType</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">MyTypes</span><span class="p">):</span>
    <span class="n">ThisType</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
    <span class="n">ThisType</span><span class="o">.</span><span class="n">initialize_sim</span><span class="p">()</span>
    <span class="n">ThisType</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:25&lt;00:00,  3.63s/it]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aLvl_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">ThisType</span><span class="o">.</span><span class="n">state_now</span><span class="p">[</span><span class="s2">&quot;aLvl&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ThisType</span> <span class="ow">in</span> <span class="n">MyTypes</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;The ratio of aggregate capital to permanent income is &quot;</span>
    <span class="o">+</span> <span class="n">decfmt2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">aLvl_all</span><span class="p">))</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The ratio of aggregate capital to permanent income is 10.22
</pre></div>
</div>
</div>
</div>
</section>
<section id="solution-using-the-agentpopulation-class">
<h3>2. Solution using the <code class="docutils literal notranslate"><span class="pre">AgentPopulation</span></code> class<a class="headerlink" href="#solution-using-the-agentpopulation-class" title="Permalink to this heading">#</a></h3>
<p>We now conduct the same exercise for the new tool implemented in HARK. As you can see, both the out for the solution and the mean level of assets are nearly identical to the output when using the “brute force” approach.</p>
<p>Note: As an aside, the working theory for why these two approaches give nearly-but-not-perfectly-identical solution outputs is that, the “brute force” approach requires the user to specify the random seed when creating the discretized distribution of agents. The approach using <code class="docutils literal notranslate"><span class="pre">AgentPopulation</span></code>, on the other hand, specifies the random seed for the user during the implementation of the code. As you may know from the basics of programming in Python, the random seed’s main function is for reproducibility of results when using random number generators. In order for this theory to be tested, the <code class="docutils literal notranslate"><span class="pre">AgentPopulation</span></code> tool in HARK must be updated to allow for users to fix the random seed in this way.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SubPops</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="n">SubPops</span><span class="o">.</span><span class="n">initialize_sim</span><span class="p">()</span>
<span class="n">SubPops</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>

<span class="c1"># time this second solution method</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aLvl_all_ap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">ThisSubPop</span><span class="o">.</span><span class="n">state_now</span><span class="p">[</span><span class="s2">&quot;aLvl&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ThisSubPop</span> <span class="ow">in</span> <span class="n">SubPops</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;The ratio of aggregate capital to permanent income is &quot;</span>
    <span class="o">+</span> <span class="n">decfmt2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">aLvl_all_ap</span><span class="p">))</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The ratio of aggregate capital to permanent income is 10.29
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="plotting-the-lorenz-curve">
<h2>Plotting the Lorenz Curve<a class="headerlink" href="#plotting-the-lorenz-curve" title="Permalink to this heading">#</a></h2>
<p>Next, we conduct the exercise of matching the inequality in the observable distribution of wealth using the distribution of assets that arises from the model we’ve constructed with ex-ante heterogeneity in the time preference factor. As you can see from the plots below, the matching exercise is again nearly identical from the two approaches.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute Lorenz shares using the brute force approach</span>

<span class="n">SCF_wealth</span><span class="p">,</span> <span class="n">SCF_weights</span> <span class="o">=</span> <span class="n">load_SCF_wealth_weights</span><span class="p">()</span>

<span class="n">pctiles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.999</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">sim_wealth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">ThisType</span><span class="o">.</span><span class="n">state_now</span><span class="p">[</span><span class="s2">&quot;aLvl&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ThisType</span> <span class="ow">in</span> <span class="n">MyTypes</span><span class="p">])</span>
<span class="n">SCF_Lorenz_points</span> <span class="o">=</span> <span class="n">get_lorenz_shares</span><span class="p">(</span>
    <span class="n">SCF_wealth</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">SCF_weights</span><span class="p">,</span> <span class="n">percentiles</span><span class="o">=</span><span class="n">pctiles</span>
<span class="p">)</span>
<span class="n">sim_Lorenz_points</span> <span class="o">=</span> <span class="n">get_lorenz_shares</span><span class="p">(</span><span class="n">sim_wealth</span><span class="p">,</span> <span class="n">percentiles</span><span class="o">=</span><span class="n">pctiles</span><span class="p">)</span>

<span class="c1"># Compute Lorenz shares using the `AgentPopulation` approach</span>

<span class="n">sim_wealth_ap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">ThisSubPop</span><span class="o">.</span><span class="n">state_now</span><span class="p">[</span><span class="s2">&quot;aLvl&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ThisSubPop</span> <span class="ow">in</span> <span class="n">SubPops</span><span class="p">])</span>
<span class="n">SCF_Lorenz_points_ap</span> <span class="o">=</span> <span class="n">get_lorenz_shares</span><span class="p">(</span>
    <span class="n">SCF_wealth</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">SCF_weights</span><span class="p">,</span> <span class="n">percentiles</span><span class="o">=</span><span class="n">pctiles</span>
<span class="p">)</span>
<span class="n">sim_Lorenz_points_ap</span> <span class="o">=</span> <span class="n">get_lorenz_shares</span><span class="p">(</span><span class="n">sim_wealth_ap</span><span class="p">,</span> <span class="n">percentiles</span><span class="o">=</span><span class="n">pctiles</span><span class="p">)</span>

<span class="c1"># Plot Lorenz curves for model with uniform distribution of time preference using both methods</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pctiles</span><span class="p">,</span> <span class="n">SCF_Lorenz_points</span><span class="p">,</span> <span class="s2">&quot;--k&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pctiles</span><span class="p">,</span> <span class="n">sim_Lorenz_points</span><span class="p">,</span> <span class="s2">&quot;-b&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Brute force approach&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Percentile of net worth&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cumulative share of wealth&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pctiles</span><span class="p">,</span> <span class="n">SCF_Lorenz_points</span><span class="p">,</span> <span class="s2">&quot;--k&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pctiles</span><span class="p">,</span> <span class="n">sim_Lorenz_points_ap</span><span class="p">,</span> <span class="s2">&quot;-b&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Using AgentPopulation class&quot;</span><span class="p">)</span>
<span class="c1"># plt.xlabel(&quot;Percentile of net worth&quot;)</span>
<span class="c1"># plt.ylabel(&quot;Cumulative share of wealth&quot;)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f05b6a9c6b07b5ddeb9db4503f8d471a4b26323b12866bca59e31559f31d776f.png" src="../_images/f05b6a9c6b07b5ddeb9db4503f8d471a4b26323b12866bca59e31559f31d776f.png" />
</div>
</div>
</section>
<section id="calculating-the-lorenz-distance-at-targets">
<h2>Calculating the Lorenz Distance at Targets<a class="headerlink" href="#calculating-the-lorenz-distance-at-targets" title="Permalink to this heading">#</a></h2>
<p>Now we want to construct a function that calculates the Euclidean distance between simulated and actual Lorenz curves at the four percentiles of interest: 20, 40, 60, and 80.</p>
<p>NB: For some reason, this step is not completed in the code. We leave this cell here, as this exercise should probably be performed as well.</p>
</section>
<section id="the-distribution-of-the-marginal-propensity-to-consume">
<h2>The Distribution Of the Marginal Propensity to Consume<a class="headerlink" href="#the-distribution-of-the-marginal-propensity-to-consume" title="Permalink to this heading">#</a></h2>
<p>For many macroeconomic purposes, the distribution of the MPC <span class="math notranslate nohighlight">\(\kappa\)</span> is more important than the distribution of wealth.  Ours is a quarterly model, and MPC’s are typically reported on an annual basis; we can compute a (very) approximate annual MPC from the quraterly ones as <span class="math notranslate nohighlight">\(\kappa_{Y} \approx 1.0 - (1.0 - \kappa_{Q})^4\)</span></p>
<p>In the cell below, we retrieve the MPCs from our simulated consumers and show that the 10th percentile in the MPC distribution is only about 6 percent, while at the 90th percentile it is almost 0.5</p>
<section id="mpc-distribution-from-the-brute-force-approach">
<h3>1. MPC distribution from the “brute force” approach<a class="headerlink" href="#mpc-distribution-from-the-brute-force-approach" title="Permalink to this heading">#</a></h3>
<p>Again, we first show the computation from the “brute force approach”. This is done in the following code block.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieve the MPC&#39;s</span>
<span class="n">percentiles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">MPC_sim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">ThisType</span><span class="o">.</span><span class="n">MPCnow</span> <span class="k">for</span> <span class="n">ThisType</span> <span class="ow">in</span> <span class="n">MyTypes</span><span class="p">])</span>
<span class="n">MPCpercentiles_quarterly</span> <span class="o">=</span> <span class="n">get_percentiles</span><span class="p">(</span><span class="n">MPC_sim</span><span class="p">,</span> <span class="n">percentiles</span><span class="o">=</span><span class="n">percentiles</span><span class="p">)</span>
<span class="n">MPCpercentiles_annual</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">MPCpercentiles_quarterly</span><span class="p">)</span> <span class="o">**</span> <span class="mi">4</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;The MPC at the 10th percentile of the distribution is &quot;</span>
    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">decfmt2</span><span class="p">(</span><span class="n">MPCpercentiles_annual</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;The MPC at the 50th percentile of the distribution is &quot;</span>
    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">decfmt2</span><span class="p">(</span><span class="n">MPCpercentiles_annual</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;The MPC at the 90th percentile of the distribution is &quot;</span>
    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">decfmt2</span><span class="p">(</span><span class="n">MPCpercentiles_annual</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The MPC at the 10th percentile of the distribution is 0.06
The MPC at the 50th percentile of the distribution is 0.20
The MPC at the 90th percentile of the distribution is 0.49
</pre></div>
</div>
</div>
</div>
</section>
<section id="mpc-distribution-from-the-agentpopulation-approach">
<h3>2. MPC distribution from the <code class="docutils literal notranslate"><span class="pre">AgentPopulation</span></code> approach<a class="headerlink" href="#mpc-distribution-from-the-agentpopulation-approach" title="Permalink to this heading">#</a></h3>
<p>Next, we compare this distribution of marginal propensities to consume with the one from the analogous computation when the <code class="docutils literal notranslate"><span class="pre">AgentPopulation</span></code> class is used. Notably, the distribution of MPCs in this case is nearly identical, with the only difference being at the 90th percentile.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieve the MPC&#39;s</span>
<span class="n">percentiles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">MPC_sim_ap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">ThisSubPop</span><span class="o">.</span><span class="n">MPCnow</span> <span class="k">for</span> <span class="n">ThisSubPop</span> <span class="ow">in</span> <span class="n">SubPops</span><span class="p">])</span>
<span class="n">MPCpercentiles_quarterly_ap</span> <span class="o">=</span> <span class="n">get_percentiles</span><span class="p">(</span><span class="n">MPC_sim_ap</span><span class="p">,</span> <span class="n">percentiles</span><span class="o">=</span><span class="n">percentiles</span><span class="p">)</span>
<span class="n">MPCpercentiles_annual_ap</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">MPCpercentiles_quarterly_ap</span><span class="p">)</span> <span class="o">**</span> <span class="mi">4</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;The MPC at the 10th percentile of the distribution is &quot;</span>
    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">decfmt2</span><span class="p">(</span><span class="n">MPCpercentiles_annual_ap</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;The MPC at the 50th percentile of the distribution is &quot;</span>
    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">decfmt2</span><span class="p">(</span><span class="n">MPCpercentiles_annual_ap</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;The MPC at the 90th percentile of the distribution is &quot;</span>
    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">decfmt2</span><span class="p">(</span><span class="n">MPCpercentiles_annual_ap</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The MPC at the 10th percentile of the distribution is 0.06
The MPC at the 50th percentile of the distribution is 0.20
The MPC at the 90th percentile of the distribution is 0.51
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="adding-very-impatient-households">
<h2>Adding Very Impatient Households<a class="headerlink" href="#adding-very-impatient-households" title="Permalink to this heading">#</a></h2>
<p>Now that we have some tools for examining both microeconomic (the MPC across the population) and macroeconomic (the distribution and overall level of wealth) outcomes from our model, we are all set to conduct our experiment.</p>
<p>In this exercise, we are going to add very impatient households to the economy in a very direct way: by replacing the <em>most impatient consumer type</em> with an <em>even more impatient type</em>.  Specifically, we will have these agents have a discount factor of <span class="math notranslate nohighlight">\(\beta = 0.80\)</span> at a quarterly frequency, which corresponds to <span class="math notranslate nohighlight">\(\beta \approx 0.41\)</span> annual.</p>
<p>In the code block below, we:</p>
<ol class="arabic simple">
<li><p>Replicate the list of agents using <span class="math notranslate nohighlight">\(\texttt{deepcopy}\)</span>.</p></li>
<li><p>Set the <span class="math notranslate nohighlight">\(\beta\)</span> of the most impatient type to <span class="math notranslate nohighlight">\(0.80\)</span> (for the copied set of agents).</p></li>
<li><p>Solve and simulate the most impatient type (for the copied set of agents).</p></li>
</ol>
<p>We conduct this exercise for both approaches again. The code is essentially identical, other than the naming conventions used for variables in each case. Notice that the output from each of the final two code blocks are exactly identical!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Follow the instructions above to make another list of agents that includes *very* impatient households.</span>
<span class="n">NewTypes</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">MyTypes</span><span class="p">)</span>
<span class="n">NewTypes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">DiscFac</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">NewTypes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="n">NewTypes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">initialize_sim</span><span class="p">()</span>
<span class="n">NewTypes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>

<span class="c1"># Retrieve the MPC&#39;s</span>
<span class="n">percentiles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">MPC_sim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">ThisType</span><span class="o">.</span><span class="n">MPCnow</span> <span class="k">for</span> <span class="n">ThisType</span> <span class="ow">in</span> <span class="n">NewTypes</span><span class="p">])</span>
<span class="n">MPCpercentiles_quarterly</span> <span class="o">=</span> <span class="n">get_percentiles</span><span class="p">(</span><span class="n">MPC_sim</span><span class="p">,</span> <span class="n">percentiles</span><span class="o">=</span><span class="n">percentiles</span><span class="p">)</span>
<span class="n">MPCpercentiles_annual</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">MPCpercentiles_quarterly</span><span class="p">)</span> <span class="o">**</span> <span class="mi">4</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;The MPC at the 10th percentile of the distribution is &quot;</span>
    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">decfmt2</span><span class="p">(</span><span class="n">MPCpercentiles_annual</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;The MPC at the 50th percentile of the distribution is &quot;</span>
    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">decfmt2</span><span class="p">(</span><span class="n">MPCpercentiles_annual</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;The MPC at the 90th percentile of the distribution is &quot;</span>
    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">decfmt2</span><span class="p">(</span><span class="n">MPCpercentiles_annual</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="p">)</span>

<span class="c1"># these last two slides need an edit if this is the wealth distribution.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The MPC at the 10th percentile of the distribution is 0.06
The MPC at the 50th percentile of the distribution is 0.20
The MPC at the 90th percentile of the distribution is 0.97
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Follow the instructions above to make another list of agents that includes *very* impatient households.</span>
<span class="n">NewSubPops</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">SubPops</span><span class="p">)</span>
<span class="n">NewSubPops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">DiscFac</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">NewSubPops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="n">NewSubPops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">initialize_sim</span><span class="p">()</span>
<span class="n">NewSubPops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>

<span class="c1"># Retrieve the MPC&#39;s</span>
<span class="n">percentiles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">MPC_sim_ap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">ThisSubPop</span><span class="o">.</span><span class="n">MPCnow</span> <span class="k">for</span> <span class="n">ThisSubPop</span> <span class="ow">in</span> <span class="n">NewSubPops</span><span class="p">])</span>
<span class="n">MPCpercentiles_quarterly_ap</span> <span class="o">=</span> <span class="n">get_percentiles</span><span class="p">(</span><span class="n">MPC_sim_ap</span><span class="p">,</span> <span class="n">percentiles</span><span class="o">=</span><span class="n">percentiles</span><span class="p">)</span>
<span class="n">MPCpercentiles_annual_ap</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">MPCpercentiles_quarterly_ap</span><span class="p">)</span> <span class="o">**</span> <span class="mi">4</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;The MPC at the 10th percentile of the distribution is &quot;</span>
    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">decfmt2</span><span class="p">(</span><span class="n">MPCpercentiles_annual_ap</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;The MPC at the 50th percentile of the distribution is &quot;</span>
    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">decfmt2</span><span class="p">(</span><span class="n">MPCpercentiles_annual_ap</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;The MPC at the 90th percentile of the distribution is &quot;</span>
    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">decfmt2</span><span class="p">(</span><span class="n">MPCpercentiles_annual_ap</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The MPC at the 10th percentile of the distribution is 0.06
The MPC at the 50th percentile of the distribution is 0.20
The MPC at the 90th percentile of the distribution is 0.97
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "econ-ark/DemARK",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="MPC-Out-of-Credit-vs-MPC-Out-of-Income.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">The MPC out of Credit vs the MPC Out of Income</p>
      </div>
    </a>
    <a class="right-next"
       href="Nondurables-During-Great-Recession.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Spending on Nondurables During the Great Recession</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Micro- and Macroeconomic Implications of Very Impatient Households</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calibrating-a-basic-version-of-cstwmpc">Calibrating a Basic Version of cstwMPC</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-an-ex-ante-distribution-of-heterogeneous-agents">Creating an ex-ante distribution of heterogeneous agents</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#method-1-brute-force-approach">Method 1: “Brute force” approach</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#method-2-the-new-agentpopulation-class">Method 2: The new <code class="docutils literal notranslate"><span class="pre">AgentPopulation</span></code> class</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-and-simulating-the-baseline-agents">Solving and Simulating the Baseline Agents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-for-the-brute-force-approach">1. Solution for the “brute force” approach</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-using-the-agentpopulation-class">2. Solution using the <code class="docutils literal notranslate"><span class="pre">AgentPopulation</span></code> class</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-lorenz-curve">Plotting the Lorenz Curve</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-the-lorenz-distance-at-targets">Calculating the Lorenz Distance at Targets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-distribution-of-the-marginal-propensity-to-consume">The Distribution Of the Marginal Propensity to Consume</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mpc-distribution-from-the-brute-force-approach">1. MPC distribution from the “brute force” approach</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mpc-distribution-from-the-agentpopulation-approach">2. MPC distribution from the <code class="docutils literal notranslate"><span class="pre">AgentPopulation</span></code> approach</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-very-impatient-households">Adding Very Impatient Households</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Econ-ARK Team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>